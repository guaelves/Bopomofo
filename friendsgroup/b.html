<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ㄅ 的好朋友 — 拼音組合練習</title>
  <style>
    body {
      font-family: "Noto Sans TC", "Microsoft JhengHei", sans-serif;
      text-align: center;
      background: #f8f8f8;
      color: #333;
      max-width: 980px;
      margin: 24px auto;
      padding: 0 16px 40px;
    }

    h1 {
      color: #00695c;
      margin-bottom: 6px;
    }

    .subtitle {
      color: #555;
      margin-bottom: 18px;
    }

    .controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 18px;
      margin-bottom: 18px;
    }

    .big-b {
      background: #bbdefb;
      color: #333;
      font-size: 5.5rem;
      font-weight: bold;
      width: 120px;
      height: 120px;
      border-radius: 12px;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 0 8px rgba(0,0,0,0.08);
    }

    button {
      background: #009688;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 16px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
    }
    button:hover { background: #00796b; }

    #table-wrap {
      overflow-x: auto;
      margin: 10px auto;
      max-width: 100%;
      background: white;
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.03);
    }

    .pinyin-table {
      border-collapse: collapse;
      width: 100%;
      min-width: 720px;
    }

    .pinyin-table th,
    .pinyin-table td {
      border: 1px solid #e6e6e6;
      padding: 10px;
      text-align: center;
      vertical-align: middle;
    }

    .pinyin-table th {
      background: #f3f7f7;
      font-weight: 700;
      color: #2f6b63;
    }

    .pinyin-table td.left-col {
      background: #fafafa;
      text-align: left;
      padding-left: 16px;
      width: 160px;
      font-weight: 700;
      color: #455a64;
    }

    .cell-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      user-select: none;
    }

    .pinyin-main {
      font-size: 1.6rem;
      font-weight: 800;
      color: #00695c;
    }

    .pinyin-tone {
      font-size: 0.9rem;
      color: #7a7a7a;
    }

    .cell {
      cursor: pointer;
      transition: background 0.18s, transform 0.08s;
      background: #fff;
    }
    .cell:hover { transform: translateY(-2px); }
    .cell.selected {
      background: #d9fdd3;
      box-shadow: inset 0 0 0 3px rgba(0,150,136,0.07);
    }

    .cell.wrong {
      background: #ffd6d6;
    }

    @media (max-width: 640px) {
      .big-b { width: 90px; height: 90px; font-size: 4rem; }
      .pinyin-main { font-size: 1.2rem; }
      .pinyin-table { min-width: 560px; }
    }
  </style>
</head>
<body>
  <h1>ㄅ 的好朋友 — 拼音組合練習</h1>
  <div class="subtitle">第一行：聲符 ｜ 第一列（靠左）：好朋友</div>

  <div class="controls">
    <div class="big-b">ㄅ</div>
    <button id="resetBtn">🔄 重新開始</button>
  </div>

  <div id="table-wrap"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // ---- 音效 ----
      function playBeep(frequency, duration) {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.type = "sine";
        osc.frequency.value = frequency;
        gain.gain.setValueAtTime(0.08, ctx.currentTime);
        osc.start();
        osc.stop(ctx.currentTime + duration / 1000);
      }
      function playSelect() {
        playBeep(880, 90);
        setTimeout(() => playBeep(1320, 80), 120);
      }
      function playDeselect() {
        playBeep(260, 160);
      }

      // ---- 資料 ----
      const friends = [
        "ㄧ", "ㄨ", "ㄚ", "ㄛ", "ㄞ", "ㄟ", "ㄠ", "ㄢ", "ㄣ", "ㄤ", "ㄥ",
        "ㄧㄝ", "ㄧㄠ", "ㄧㄢ", "ㄧㄣ", "ㄧㄥ"
      ];

      const tones = [
        { label: "一聲", sym: "「」" },
        { label: "二聲", sym: "「/」" },
        { label: "三聲", sym: "「V」" },
        { label: "四聲", sym: "「﹨」" },
        { label: "輕聲", sym: "「˙」" }
      ];

      const tableWrap = document.getElementById('table-wrap');

      function buildTable() {
        const table = document.createElement('table');
        table.className = 'pinyin-table';

        // header row
        const thead = document.createElement('thead');
        const hrow = document.createElement('tr');

        const cornerTh = document.createElement('th');
        cornerTh.textContent = '好朋友 \\ 聲符';
        hrow.appendChild(cornerTh);

        tones.forEach(t => {
          const th = document.createElement('th');
          const label = document.createElement('div');
          label.textContent = t.label;
          const sym = document.createElement('div');
          sym.textContent = t.sym;
          sym.style.fontSize = '0.85rem';
          sym.style.marginTop = '6px';
          th.appendChild(label);
          th.appendChild(sym);
          hrow.appendChild(th);
        });

        thead.appendChild(hrow);
        table.appendChild(thead);

        const tbody = document.createElement('tbody');

        friends.forEach(friend => {
          const tr = document.createElement('tr');

          const leftTd = document.createElement('td');
          leftTd.className = 'left-col';
          leftTd.innerHTML = `<div style="display:flex;flex-direction:column;gap:6px;">
                                <div style="font-size:1.2rem">${friend}</div>
                                <div style="font-size:0.9rem;color:#7a7a7a">（與 ㄅ 組合）</div>
                              </div>`;
          tr.appendChild(leftTd);

          tones.forEach(t => {
            const td = document.createElement('td');
            td.className = 'cell';

            const content = document.createElement('div');
            content.className = 'cell-content';

            const main = document.createElement('div');
            main.className = 'pinyin-main';
            main.textContent = 'ㄅ' + friend;

            const toneSpan = document.createElement('div');
            toneSpan.className = 'pinyin-tone';
            toneSpan.textContent = t.sym.replace(/[「」]/g, '');

            content.appendChild(main);
            content.appendChild(toneSpan);
            td.appendChild(content);

            td.dataset.friend = friend;
            td.dataset.tone = t.label;

            td.addEventListener('click', () => {
              const already = td.classList.contains('selected');
              if (!already) {
                td.classList.add('selected');
                playSelect();
              } else {
                td.classList.remove('selected');
                playDeselect();
              }
            });

            tr.appendChild(td);
          });

          tbody.appendChild(tr);
        });

        table.appendChild(tbody);
        return table;
      }

      tableWrap.innerHTML = '';
      tableWrap.appendChild(buildTable());

      document.getElementById('resetBtn').addEventListener('click', () => {
        document.querySelectorAll('.cell').forEach(c => c.classList.remove('selected', 'wrong'));
      });
    });
  </script>
</body>
</html>
